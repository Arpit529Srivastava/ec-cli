name: ec fetch commit
synopsis: Fetch authorizations from a git repository
description: |-
    Fetch authorizations from a git repository

    An authorization, within the context of this command, is loosely
    defined as the person who appears in the "Signed-off-by:" line
    in the git commit message.

    This command also verifies the provided images have been attested
    with the provided public key.

    The git commit and git repository are extracted from the field
    ".predicate.materials" of the image attestation.
usage: ec fetch commit [flags]
options:
    - name: file-path
      shorthand: f
      usage: path to ApplicationSnapshot Spec JSON file
    - name: help
      shorthand: h
      default_value: "false"
      usage: help for commit
    - name: image-ref
      usage: OCI reference to the attested image
    - name: json-input
      shorthand: j
      usage: JSON representation of an ApplicationSnapshot Spec
    - name: public-key
      usage: |
        path to the public key associated with the image attestation(s)
inherited_options:
    - name: debug
      default_value: "false"
      usage: |
        same as verbose but also show function names and line numbers
    - name: quiet
      default_value: "false"
      usage: less verbose output
    - name: verbose
      default_value: "false"
      usage: more verbose output
example: |-
    Process git commit from a single image:

      ec fetch commit --image-ref <image url> --public-key <path/to/public/key>

    Process git commit from an ApplicationSnapshot Spec file:

      ec fetch commit --file-path <path/to/ApplicationSnapshot/file> --public-key <path/to/public/key>

    Process git commit from an inline ApplicationSnapshot Spec:

      ec fetch commit --json-input '{"components":[{"containerImage":"<image url>"}]}' --public-key <path/to/public/key>

    Use public key from a kubernetes secret:

      ec fetch commit --image-ref <image url> --public-key k8s://<namespace>/<secret-name>
see_also:
    - ec fetch - Fetch data for policy evaluation
